!function(t,e){for(var n in e)t[n]=e[n]}(exports,function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="/dist/",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){var i=n(2),r=n(29);e.readScenario=function(t,e){return void 0===e&&(e=!1),i["default"](r.createASDataView(t),e)},e.readScenarioFile=function(t,e){void 0===e&&(e=!1);var a=n(31),o=a.readFileSync(t);return i["default"](r.createASDataView(o.buffer),e)},Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={readScenario:e.readScenario,readScenarioFile:e.readScenarioFile}},function(t,e,n){var i=n(3),r=n(10),a=n(11),o=n(12),s=n(13),u=n(14),c=n(15),g=n(16),l=n(17),f=n(18),d=n(19),p=n(20),I=n(21),v=n(23),h=function(t,e){void 0===e&&(e=!1),e&&console.log("AgeScx: starting reading scenario");var n=i["default"](),h=n.players.slice(1,9),y=n.players.slice(0,9);a.readHeader(n,t),e&&console.log("AgeScx: header loaded, version = "+n.header.version),t.inflate(n.header.size+8),n.setup.nextId=t.getUint32(),n.version=t.getFloat32(),e&&console.log("AgeScx: compressed data version = "+n.version),y.forEach(function(e){e.name=t.getChar(256)}),t.skip(1792),y.forEach(function(e){e.nameId=t.getInt32()}),t.skip(28),o.readPlayerData1(n,t),e&&console.log("AgeScx: Player Data #1 - Basic Info"),t.skip(4),t.skip(4),t.skip(1),n.setup.filename=t.getStr16(),l.readMessages(n,t),e&&console.log("AgeScx: Messages"),f.readCinematics(n,t),e&&console.log("AgeScx: Cinematics"),d.readImage(n,t),e&&console.log("AgeScx: Background Image"),s.readPlayerData2(n,t),e&&console.log("AgeScx: Player Data #2 - AI section"),t.skip(384),t.skip(4),g.readGoals(n,t),e&&console.log("AgeScx: Scenario Goals"),h.forEach(function(e){for(var n=0;8>n;n++)e.diplomacy.push(t.getInt32());t.skip(32)}),t.skip(512),t.skip(11520),t.skip(4),t.skip(64),e&&console.log("AgeScx: Diplomacy"),p.readDisabled(n,t),e&&console.log("AgeScx: Disables"),t.skip(8),n.setup.allTech=t.getInt32(),y.forEach(function(e){e.age=t.getInt32()}),t.skip(28),t.skip(4),n.setup.startCam=[t.getInt32(),t.getInt32()],n.setup.aiType=t.getUint32(),n.setup.width=t.getUint32(),n.setup.height=t.getUint32(),e&&console.log("AgeScx: Scenario setup");for(var k=0;k<n.setup.width*n.setup.height;k++)n.tiles.push(r.readTile(t));e&&console.log("AgeScx: Scenario tiles"),t.skip(4),u.readPlayerData3(n,t),e&&console.log("AgeScx: Player Data #3 - Resources"),I.readUnits(n,t),e&&console.log("AgeScx: Scenario Units"),t.skip(4),c.readPlayerData4(n,t),e&&console.log("AgeScx: Player Data #4 - Advanced"),t.skip(8),t.skip(1),v.readTriggers(n,t),e&&console.log("AgeScx: Triggers"),console.log(n)};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=h},function(t,e,n){var i=n(4),r=n(8),a=n(9),o=function(){return{header:a["default"](),version:1.22,players:[i["default"](),i["default"](),i["default"](),i["default"](),i["default"](),i["default"](),i["default"](),i["default"](),i["default"]()],messages:{objectives:r["default"](),hints:r["default"](),victory:r["default"](),loss:r["default"](),history:r["default"](),scout:r["default"]()},cinematics:{intro:"",defeat:"",victory:""},image:{filename:"",included:0,width:0,height:0,exists:0,raw:""},goals:{conquest:0,relics:0,exploration:0,all:0,mode:0,score:0,time:0,unk1:0,unk2:0,unk3:0},setup:{allTech:0,aiType:0,startCam:[0,0],height:0,width:0,nextId:0,filename:""},tiles:[],triggers:[],triggersOrd:[]}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o},function(t,e,n){var i=n(5),r=n(6),a=n(7),o=function(){return{name:"",nameId:0,constName:"",active:0,human:0,civ:i["default"].Britons,unk1:0,unk2:0,unk3:0,aiName:"",aiSource:"",aiType:0,age:a["default"].None,population:100,color:r["default"].Gray,food:0,wood:0,gold:0,stone:0,ore:0,diplomacy:[],alliedVict:0,startCam:[0,0],disTechs:[],disBuildings:[],disUnits:[],units:[]}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=o},function(t,e){var n;!function(t){t[t.Britons=0]="Britons",t[t.Franks=1]="Franks",t[t.Goths=3]="Goths",t[t.Teutons=4]="Teutons",t[t.Japanese=5]="Japanese",t[t.Chinese=6]="Chinese",t[t.Byzantines=7]="Byzantines",t[t.Persians=8]="Persians",t[t.Saracens=9]="Saracens",t[t.Turks=10]="Turks",t[t.Vikings=11]="Vikings",t[t.Mongols=12]="Mongols",t[t.Celts=13]="Celts",t[t.Spanish=14]="Spanish",t[t.Aztecs=15]="Aztecs",t[t.Mayans=16]="Mayans",t[t.Huns=17]="Huns",t[t.Koreans=18]="Koreans"}(n||(n={})),Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e){var n;!function(t){t[t.Blue=0]="Blue",t[t.Red=1]="Red",t[t.Green=2]="Green",t[t.Yellow=3]="Yellow",t[t.Cyan=4]="Cyan",t[t.Purple=5]="Purple",t[t.Gray=6]="Gray",t[t.Orange=7]="Orange"}(n||(n={})),Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e){var n;!function(t){t[t.None=-1]="None",t[t.Dark=0]="Dark",t[t.Feudal=1]="Feudal",t[t.Castle=2]="Castle",t[t.Imperial=3]="Imperial",t[t.PostImperial=4]="PostImperial"}(n||(n={})),Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e){var n=function(){return{id:0,text:""}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e){var n=function(t){return void 0===t&&(t="1.21"),{version:"",size:0,lastSave:20,instructions:"",players:8,unknown1:2,unknown2:0}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e){e.readTile=function(t){return{type:t.getUint8(),level:t.getUint8(),unk1:t.getUint8()}}},function(t,e){e.readHeader=function(t,e){var n=t.header;n.version=e.getChar(4),n.size=e.getUint32(),n.unknown1=e.getUint32(),n.lastSave=e.getUint32(),n.instructions=e.getStr32(),n.unknown2=e.getInt32(),n.players=e.getInt32()}},function(t,e){e.readPlayerData1=function(t,e){var n=t.players;n.forEach(function(t){t.active=e.getUint32(),t.human=e.getUint32(),t.civ=e.getInt32(),t.unk1=e.getUint32()}),e.skip(112)}},function(t,e){e.readPlayerData2=function(t,e){for(var n=t.players.slice(1,9),i=0;16>i;i++)e.getStr16(),e.getStr16();n.forEach(function(t){t.aiName=e.getStr16()});for(var i=0;8>i;i++)e.getStr16();n.forEach(function(t){e.skip(8),t.aiSource=e.getStr32()});for(var i=0;8>i;i++)e.skip(8),e.getStr32();n.forEach(function(t){t.aiType=e.getInt8()}),e.skip(8),e.skip(4)}},function(t,e){e.readPlayerData3=function(t,e){var n=t.players.slice(1,9);n.forEach(function(t){t.food=e.getFloat32(),t.wood=e.getFloat32(),t.gold=e.getFloat32(),t.stone=e.getFloat32(),t.ore=e.getFloat32(),e.skip(4),t.population=e.getFloat32()})}},function(t,e){e.readPlayerData4=function(t,e){var n=t.players.slice(1,9);n.forEach(function(t){t.constName=e.getStr16(),t.startCam=[e.getFloat32(),e.getFloat32()],e.skip(4),e.skip(1);var n=e.getUint16();e.skip(1*n),e.skip(36),t.color=e.getUint32(),t.unk2=e.getFloat32(),t.unk3=e.getUint16(),2===t.unk2&&e.skip(8),e.skip(44*t.unk3),e.skip(7),e.skip(4)})}},function(t,e){e.readGoals=function(t,e){var n=t.goals;n.conquest=e.getInt32(),n.unk1=e.getInt32(),n.relics=e.getInt32(),n.unk2=e.getInt32(),n.exploration=e.getInt32(),n.unk3=e.getInt32(),n.all=e.getInt32(),n.mode=e.getInt32(),n.score=e.getInt32(),n.time=e.getInt32()}},function(t,e){e.readMessages=function(t,e){var n=t.messages;n.objectives.id=e.getInt32(),n.hints.id=e.getInt32(),n.victory.id=e.getInt32(),n.loss.id=e.getInt32(),n.history.id=e.getInt32(),n.scout.id=e.getInt32(),n.objectives.text=e.getStr16(),n.hints.text=e.getStr16(),n.victory.text=e.getStr16(),n.loss.text=e.getStr16(),n.history.text=e.getStr16(),n.scout.text=e.getStr16()}},function(t,e){e.readCinematics=function(t,e){var n=t.cinematics;n.intro=e.getStr16(),n.defeat=e.getStr16(),n.victory=e.getStr16()}},function(t,e){e.readImage=function(t,e){var n=t.image;n.filename=e.getStr16(),n.included=e.getInt32(),n.width=e.getInt32(),n.height=e.getInt32(),n.exists=e.getInt16(),-1===n.exists||2===n.exists}},function(t,e){e.readDisabled=function(t,e){var n=t.players.slice(1,9);e.skip(64),n.forEach(function(t){for(var n=0;30>n;n++)t.disTechs.push(e.getInt32())}),e.skip(960),e.skip(64),n.forEach(function(t){for(var n=0;30>n;n++)t.disUnits.push(e.getInt32())}),e.skip(960),e.skip(64),n.forEach(function(t){for(var n=0;20>n;n++)t.disBuildings.push(e.getInt32())}),e.skip(640)}},function(t,e,n){var i=n(22);e.readUnits=function(t,e){var n=t.players;n.forEach(function(t){for(var n=e.getUint32(),r=0;n>r;r++)t.units.push(i.readUnit(e))})}},function(t,e){e.readUnit=function(t){return{x:t.getFloat32(),y:t.getFloat32(),unk1:t.getFloat32(),id:t.getUint32(),type:t.getUint16(),unk2:t.getInt8(),angle:t.getFloat32(),frame:t.getUint16(),inId:t.getInt32()}}},function(t,e,n){var i=n(24);e.readTriggers=function(t,e){for(var n=e.getUint32(),r=0;n>r;r++)t.triggers.push(i.readTrigger(t,e))}},function(t,e,n){var i=n(25),r=n(27);e.readTrigger=function(t,e){var n={enable:e.getUint32(),loop:e.getInt8(),strId:e.getInt32(),desc:e.getInt8(),descOrd:e.getUint32(),timeStart:e.getUint32(),text:e.getStr32(),name:e.getStr32(),effects:[],effectsOrd:[],conditions:[],conditionsOrd:[]};console.log(n);for(var a=e.getUint32(),o=0;a>o;o++)n.effects.push(i.readEffect(e));for(var o=0;a>o;o++)n.effectsOrd.push(e.getInt32());for(var s=e.getUint32(),o=0;s>o;o++)n.conditions.push(r.readCondition(e));for(var o=0;s>o;o++)n.conditionsOrd.push(e.getInt32());return n}},function(t,e,n){var i=n(26);e.readEffect=function(t){var e=i["default"]();e.type=t.getInt32(),e.check=t.getInt32(),e.aiGoal=t.getInt32(),e.amount=t.getInt32(),e.resource=t.getInt32(),e.diplomacy=t.getInt32();var n=t.getInt32();e.unitId=t.getInt32(),e.unitName=t.getInt32(),e.source=t.getInt32(),e.target=t.getInt32(),e.tech=t.getInt32(),e.instrId=t.getInt32(),e.soundId=t.getInt32(),e.instrTime=t.getInt32(),e.triggerId=t.getInt32(),e.location=[t.getInt32(),t.getInt32()],e.area=[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()],e.unitGroup=t.getInt32(),e.unitType=t.getInt32(),e.instrPanel=t.getInt32(),e.instrText=t.getStr32(),e.soundFile=t.getStr32();for(var r=0;n>r;r++)e.unitIds.push(t.getInt32());return e}},function(t,e){var n=function(){return{type:0,check:0,aiGoal:0,resource:0,amount:0,diplomacy:0,tech:0,triggerId:0,source:0,target:0,location:[0,0],area:[0,0,0,0],unitId:0,unitName:0,unitGroup:0,unitType:0,unitIds:[],instrId:0,instrPanel:0,instrText:"",instrTime:0,soundFile:"",soundId:0}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e,n){var i=n(28);e.readCondition=function(t){var e=i["default"]();return e.type=t.getInt32(),e.check=t.getInt32(),e.amount=t.getInt32(),e.resource=t.getInt32(),e.unitObject=t.getInt32(),e.unitId=t.getInt32(),e.unitName=t.getInt32(),e.source=t.getInt32(),e.tech=t.getInt32(),e.timer=t.getInt32(),e.unknown=t.getInt32(),e.area=[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()],e.unitGroup=t.getInt32(),e.unitType=t.getInt32(),e.aiSignal=t.getInt32(),e}},function(t,e){var n=function(){return{type:0,check:0,amount:0,resource:0,unitObject:0,unitId:0,unitName:0,source:0,tech:0,timer:0,unknown:0,area:[0,0,0,0],unitGroup:0,unitType:0,aiSignal:0}};Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e,n){var i=n(30);e.createASDataView=function(t){return new i["default"](t)}},function(t,e){"use strict";var n=function(){function t(t,e){var n=this;void 0===e&&(e=0),this._offset=0,this._data=null,this.getUint8=function(){return n._getPrimitive(n._data.getUint8,1)},this.getInt8=function(){return n._getPrimitive(n._data.getInt8,1)},this.getUint16=function(){return n._getPrimitive(n._data.getUint16,2)},this.getInt16=function(){return n._getPrimitive(n._data.getInt16,2)},this.getUint32=function(){return n._getPrimitive(n._data.getUint32,4)},this.getInt32=function(){return n._getPrimitive(n._data.getInt32,4)},this.getFloat32=function(){return n._getPrimitive(n._data.getFloat32,4)},this.getFloat64=function(){return n._getPrimitive(n._data.getFloat64,8)},this._getPrimitive=function(t,e){return n._offset+=e,t.bind(n._data)(n._offset-e,!0)},this._offset=e,this._data=new DataView(t,0)}return t.prototype.inflate=function(t){void 0===t&&(t=0);var e=new Uint8Array(this._data.buffer.slice(t)),n=pako.inflate(e,{raw:!0});this._data=new DataView(n.buffer),this._offset=0},t.prototype.slice=function(e,n){return new t(this._data.buffer.slice(e,n))},t.prototype.skip=function(t){return this._offset+=t},t.prototype.setOffset=function(t){this._offset=t},t.prototype.getOffset=function(){return this._offset},t.prototype.getChar=function(t){void 0===t&&(t=1);for(var e="",n=0;t>n;n++)e+=String.fromCharCode(this.getInt8());return e},t.prototype.getCStr=function(t){void 0===t&&(t=65535);for(var e="",n=0,i="";t>n&&"\x00"!==(i=this.getChar());)e+=i;return e},t.prototype.getStr16=function(){for(var t="",e=0,n=this.getUint16();n>e;)t+=this.getChar(),e++;return t},t.prototype.getStr32=function(){for(var t="",e=0,n=this.getUint32();n>e;)t+=this.getChar(),e++;return t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=n},function(t,e){t.exports=require("fs")}]));